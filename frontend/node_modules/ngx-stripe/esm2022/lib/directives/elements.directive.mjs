import { Directive, Input, Output, EventEmitter } from '@angular/core';
import { from } from 'rxjs';
import * as i0 from "@angular/core";
import * as i1 from "../services/stripe-elements.service";
export class StripeElementsDirective {
    stripeElementsService;
    elementsOptions;
    stripe;
    elements = new EventEmitter();
    _elements;
    state = 'notready';
    constructor(stripeElementsService) {
        this.stripeElementsService = stripeElementsService;
    }
    async ngOnChanges(changes) {
        this.state = 'starting';
        const elementsOptions = this.elementsOptions;
        const stripe = this.stripe;
        if (!stripe) {
            this.state = 'notready';
            return;
        }
        if (changes.elementsOptions) {
            if (this._elements) {
                const payload = Object.keys(elementsOptions).reduce((acc, key) => {
                    if (elementsOptions[key] !== changes.elementsOptions.previousValue[key] &&
                        !['fonts', 'loader', 'clientSecret'].includes(key)) {
                        acc[key] = elementsOptions[key];
                    }
                    return acc;
                }, {});
                this._elements.update(payload);
            }
            else {
                this._elements = await this.stripeElementsService.elements(stripe, elementsOptions).toPromise();
                this.elements.emit(this._elements);
                this.state = 'ready';
            }
        }
    }
    async ngOnInit() {
        if (this.state === 'notready') {
            this.state = 'starting';
            this._elements = await this.stripeElementsService.elements(this.stripe).toPromise();
            this.elements.emit(this._elements);
            this.state = 'ready';
        }
    }
    fetchUpdates() {
        if (!this._elements)
            return null;
        return from(this._elements.fetchUpdates());
    }
    update(options) {
        if (!this._elements)
            return null;
        return this._elements.update(options);
    }
    submit() {
        if (!this._elements)
            return null;
        return from(this._elements.submit());
    }
    getElement(elementType) {
        if (!this._elements)
            return null;
        switch (elementType) {
            case 'address':
                return this._elements.getElement('address');
            case 'paymentMethodMessaging':
                return this._elements.getElement('paymentMethodMessaging');
            case 'affirmMessage':
                return this._elements.getElement('affirmMessage');
            case 'afterpayClearpayMessage':
                return this._elements.getElement('afterpayClearpayMessage');
            case 'auBankAccount':
                return this._elements.getElement('auBankAccount');
            case 'card':
                return this._elements.getElement('card');
            case 'cardNumber':
                return this._elements.getElement('cardNumber');
            case 'cardExpiry':
                return this._elements.getElement('cardExpiry');
            case 'cardCvc':
                return this._elements.getElement('cardCvc');
            case 'fpxBank':
                return this._elements.getElement('fpxBank');
            case 'epsBank':
                return this._elements.getElement('epsBank');
            case 'p24Bank':
                return this._elements.getElement('p24Bank');
            case 'iban':
                return this._elements.getElement('iban');
            case 'idealBank':
                return this._elements.getElement('idealBank');
            case 'linkAuthentication':
                return this._elements.getElement('linkAuthentication');
            case 'expressCheckout':
                return this._elements.getElement('expressCheckout');
            case 'payment':
                return this._elements.getElement('payment');
            case 'paymentRequestButton':
                return this._elements.getElement('paymentRequestButton');
            case 'shippingAddress':
                return this._elements.getElement('shippingAddress');
            default:
                return this._elements.getElement(elementType);
        }
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.1.3", ngImport: i0, type: StripeElementsDirective, deps: [{ token: i1.StripeElementsService }], target: i0.ɵɵFactoryTarget.Directive });
    static ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "17.1.3", type: StripeElementsDirective, isStandalone: true, selector: "ngx-stripe-elements,[ngxStripeElements]", inputs: { elementsOptions: "elementsOptions", stripe: "stripe" }, outputs: { elements: "elements" }, usesOnChanges: true, ngImport: i0 });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.1.3", ngImport: i0, type: StripeElementsDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: 'ngx-stripe-elements,[ngxStripeElements]',
                    standalone: true
                }]
        }], ctorParameters: () => [{ type: i1.StripeElementsService }], propDecorators: { elementsOptions: [{
                type: Input
            }], stripe: [{
                type: Input
            }], elements: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWxlbWVudHMuZGlyZWN0aXZlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LXN0cmlwZS9zcmMvbGliL2RpcmVjdGl2ZXMvZWxlbWVudHMuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFvQyxNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3pHLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxNQUFNLENBQUM7OztBQW1DNUIsTUFBTSxPQUFPLHVCQUF1QjtJQVNmO0lBUlYsZUFBZSxDQUFpQztJQUNoRCxNQUFNLENBQXlCO0lBRTlCLFFBQVEsR0FBRyxJQUFJLFlBQVksRUFBa0IsQ0FBQztJQUV4RCxTQUFTLENBQWlCO0lBQzFCLEtBQUssR0FBc0MsVUFBVSxDQUFDO0lBRXRELFlBQW1CLHFCQUE0QztRQUE1QywwQkFBcUIsR0FBckIscUJBQXFCLENBQXVCO0lBQUcsQ0FBQztJQUVuRSxLQUFLLENBQUMsV0FBVyxDQUFDLE9BQXNCO1FBQ3RDLElBQUksQ0FBQyxLQUFLLEdBQUcsVUFBVSxDQUFDO1FBRXhCLE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUM7UUFDN0MsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUUzQixJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ1gsSUFBSSxDQUFDLEtBQUssR0FBRyxVQUFVLENBQUM7WUFDeEIsT0FBTztTQUNSO1FBRUQsSUFBSSxPQUFPLENBQUMsZUFBZSxFQUFFO1lBQzNCLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtnQkFDbEIsTUFBTSxPQUFPLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUU7b0JBQy9ELElBQ0UsZUFBZSxDQUFDLEdB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QUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1lBQ3REO2dCQUNFLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLENBQUM7U0FDakQ7SUFDSCxDQUFDO3VHQXRJVSx1QkFBdUI7MkZBQXZCLHVCQUF1Qjs7MkZBQXZCLHVCQUF1QjtrQkFKbkMsU0FBUzttQkFBQztvQkFDVCxRQUFRLEVBQUUseUNBQXlDO29CQUNuRCxVQUFVLEVBQUUsSUFBSTtpQkFDakI7MEZBRVUsZUFBZTtzQkFBdkIsS0FBSztnQkFDRyxNQUFNO3NCQUFkLEtBQUs7Z0JBRUksUUFBUTtzQkFBakIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERpcmVjdGl2ZSwgSW5wdXQsIE9uSW5pdCwgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzLCBPdXRwdXQsIEV2ZW50RW1pdHRlciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgZnJvbSB9IGZyb20gJ3J4anMnO1xuXG5pbXBvcnQge1xuICBTdHJpcGVBZGRyZXNzRWxlbWVudCxcbiAgU3RyaXBlQWZmaXJtTWVzc2FnZUVsZW1lbnQsXG4gIFN0cmlwZUFmdGVycGF5Q2xlYXJwYXlNZXNzYWdlRWxlbWVudCxcbiAgU3RyaXBlQXVCYW5rQWNjb3VudEVsZW1lbnQsXG4gIFN0cmlwZUNhcmRDdmNFbGVtZW50LFxuICBTdHJpcGVDYXJkRWxlbWVudCxcbiAgU3RyaXBlQ2FyZEV4cGlyeUVsZW1lbnQsXG4gIFN0cmlwZUNhcmROdW1iZXJFbGVtZW50LFxuICBTdHJpcGVFbGVtZW50cyxcbiAgU3RyaXBlRWxlbWVudHNPcHRpb25zLFxuICBTdHJpcGVFbGVtZW50c1VwZGF0ZU9wdGlvbnMsXG4gIFN0cmlwZUVwc0JhbmtFbGVtZW50LFxuICBTdHJpcGVFeHByZXNzQ2hlY2tvdXRFbGVtZW50LFxuICBTdHJpcGVGcHhCYW5rRWxlbWVudCxcbiAgU3RyaXBlSWJhbkVsZW1lbnQsXG4gIFN0cmlwZUlkZWFsQmFua0VsZW1lbnQsXG4gIFN0cmlwZUxpbmtBdXRoZW50aWNhdGlvbkVsZW1lbnQsXG4gIFN0cmlwZVAyNEJhbmtFbGVtZW50LFxuICBTdHJpcGVQYXltZW50RWxlbWVudCxcbiAgU3RyaXBlUGF5bWVudE1ldGhvZE1lc3NhZ2luZ0VsZW1lbnQsXG4gIFN0cmlwZVBheW1lbnRSZXF1ZXN0QnV0dG9uRWxlbWVudCxcbiAgU3RyaXBlU2hpcHBpbmdBZGRyZXNzRWxlbWVudFxufSBmcm9tICdAc3RyaXBlL3N0cmlwZS1qcyc7XG5cbmltcG9ydCB7IFN0cmlwZVNlcnZpY2VJbnRlcmZhY2UgfSBmcm9tICcuLi9pbnRlcmZhY2VzL3N0cmlwZS1pbnN0YW5jZS5pbnRlcmZhY2UnO1xuXG5pbXBvcnQgeyBTdHJpcGVFbGVtZW50c1NlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9zdHJpcGUtZWxlbWVudHMuc2VydmljZSc7XG5cbkBEaXJlY3RpdmUoe1xuICBzZWxlY3RvcjogJ25neC1zdHJpcGUtZWxlbWVudHMsW25neFN0cmlwZUVsZW1lbnRzXScsXG4gIHN0YW5kYWxvbmU6IHRydWVcbn0pXG5leHBvcnQgY2xhc3MgU3RyaXBlRWxlbWVudHNEaXJlY3RpdmUgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XG4gIEBJbnB1dCgpIGVsZW1lbnRzT3B0aW9uczogUGFydGlhbDxTdHJpcGVFbGVtZW50c09wdGlvbnM+O1xuICBASW5wdXQoKSBzdHJpcGU6IFN0cmlwZVNlcnZpY2VJbnRlcmZhY2U7XG5cbiAgQE91dHB1dCgpIGVsZW1lbnRzID0gbmV3IEV2ZW50RW1pdHRlcjxTdHJpcGVFbGVtZW50cz4oKTtcblxuICBfZWxlbWVudHM6IFN0cmlwZUVsZW1lbnRzO1xuICBzdGF0ZTogJ25vdHJlYWR5JyB8ICdzdGFydGluZycgfCAncmVhZHknID0gJ25vdHJlYWR5JztcblxuICBjb25zdHJ1Y3RvcihwdWJsaWMgc3RyaXBlRWxlbWVudHNTZXJ2aWNlOiBTdHJpcGVFbGVtZW50c1NlcnZpY2UpIHt9XG5cbiAgYXN5bmMgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgIHRoaXMuc3RhdGUgPSAnc3RhcnRpbmcnO1xuXG4gICAgY29uc3QgZWxlbWVudHNPcHRpb25zID0gdGhpcy5lbGVtZW50c09wdGlvbnM7XG4gICAgY29uc3Qgc3RyaXBlID0gdGhpcy5zdHJpcGU7XG5cbiAgICBpZiAoIXN0cmlwZSkge1xuICAgICAgdGhpcy5zdGF0ZSA9ICdub3RyZWFkeSc7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGNoYW5nZXMuZWxlbWVudHNPcHRpb25zKSB7XG4gICAgICBpZiAodGhpcy5fZWxlbWVudHMpIHtcbiAgICAgICAgY29uc3QgcGF5bG9hZCA9IE9iamVjdC5rZXlzKGVsZW1lbnRzT3B0aW9ucykucmVkdWNlKChhY2MsIGtleSkgPT4ge1xuICAgICAgICAgIGlmIChcbiAgICAgICAgICAgIGVsZW1lbnRzT3B0aW9uc1trZXldICE9PSBjaGFuZ2VzLmVsZW1lbnRzT3B0aW9ucy5wcmV2aW91c1ZhbHVlW2tleV0gJiZcbiAgICAgICAgICAgICFbJ2ZvbnRzJywgJ2xvYWRlcicsICdjbGllbnRTZWNyZXQnXS5pbmNsdWRlcyhrZXkpXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICBhY2Nba2V5XSA9IGVsZW1lbnRzT3B0aW9uc1trZXldO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9LCB7fSk7XG5cbiAgICAgICAgdGhpcy5fZWxlbWVudHMudXBkYXRlKHBheWxvYWQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fZWxlbWVudHMgPSBhd2FpdCB0aGlzLnN0cmlwZUVsZW1lbnRzU2VydmljZS5lbGVtZW50cyhzdHJpcGUsIGVsZW1lbnRzT3B0aW9ucykudG9Qcm9taXNlKCk7XG4gICAgICAgIHRoaXMuZWxlbWVudHMuZW1pdCh0aGlzLl9lbGVtZW50cyk7XG5cbiAgICAgICAgdGhpcy5zdGF0ZSA9ICdyZWFkeSc7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgbmdPbkluaXQoKSB7XG4gICAgaWYgKHRoaXMuc3RhdGUgPT09ICdub3RyZWFkeScpIHtcbiAgICAgIHRoaXMuc3RhdGUgPSAnc3RhcnRpbmcnO1xuXG4gICAgICB0aGlzLl9lbGVtZW50cyA9IGF3YWl0IHRoaXMuc3RyaXBlRWxlbWVudHNTZXJ2aWNlLmVsZW1lbnRzKHRoaXMuc3RyaXBlKS50b1Byb21pc2UoKTtcbiAgICAgIHRoaXMuZWxlbWVudHMuZW1pdCh0aGlzLl9lbGVtZW50cyk7XG5cbiAgICAgIHRoaXMuc3RhdGUgPSAncmVhZHknO1xuICAgIH1cbiAgfVxuXG4gIGZldGNoVXBkYXRlcygpIHtcbiAgICBpZiAoIXRoaXMuX2VsZW1lbnRzKSByZXR1cm4gbnVsbDtcbiAgICByZXR1cm4gZnJvbSh0aGlzLl9lbGVtZW50cy5mZXRjaFVwZGF0ZXMoKSk7XG4gIH1cblxuICB1cGRhdGUob3B0aW9uczogU3RyaXBlRWxlbWVudHNVcGRhdGVPcHRpb25zKSB7XG4gICAgaWYgKCF0aGlzLl9lbGVtZW50cykgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLnVwZGF0ZShvcHRpb25zKTtcbiAgfVxuXG4gIHN1Ym1pdCgpIHtcbiAgICBpZiAoIXRoaXMuX2VsZW1lbnRzKSByZXR1cm4gbnVsbDtcbiAgICByZXR1cm4gZnJvbSh0aGlzLl9lbGVtZW50cy5zdWJtaXQoKSk7XG4gIH1cblxuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAnYWRkcmVzcycpOiBTdHJpcGVBZGRyZXNzRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdwYXltZW50TWV0aG9kTWVzc2FnaW5nJyk6IFN0cmlwZVBheW1lbnRNZXRob2RNZXNzYWdpbmdFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2FmZmlybU1lc3NhZ2UnKTogU3RyaXBlQWZmaXJtTWVzc2FnZUVsZW1lbnQgfCBudWxsO1xuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAnYWZ0ZXJwYXlDbGVhcnBheU1lc3NhZ2UnKTogU3RyaXBlQWZ0ZXJwYXlDbGVhcnBheU1lc3NhZ2VFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2F1QmFua0FjY291bnQnKTogU3RyaXBlQXVCYW5rQWNjb3VudEVsZW1lbnQgfCBudWxsO1xuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAnY2FyZCcpOiBTdHJpcGVDYXJkRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdjYXJkTnVtYmVyJyk6IFN0cmlwZUNhcmROdW1iZXJFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2NhcmRFeHBpcnknKTogU3RyaXBlQ2FyZEV4cGlyeUVsZW1lbnQgfCBudWxsO1xuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAnY2FyZEN2YycpOiBTdHJpcGVDYXJkQ3ZjRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdmcHhCYW5rJyk6IFN0cmlwZUZweEJhbmtFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2Vwc0JhbmsnKTogU3RyaXBlRXBzQmFua0VsZW1lbnQgfCBudWxsO1xuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAncDI0QmFuaycpOiBTdHJpcGVQMjRCYW5rRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdpYmFuJyk6IFN0cmlwZUliYW5FbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2lkZWFsQmFuaycpOiBTdHJpcGVJZGVhbEJhbmtFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2xpbmtBdXRoZW50aWNhdGlvbicpOiBTdHJpcGVMaW5rQXV0aGVudGljYXRpb25FbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2V4cHJlc3NDaGVja291dCcpOiBTdHJpcGVFeHByZXNzQ2hlY2tvdXRFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ3BheW1lbnQnKTogU3RyaXBlUGF5bWVudEVsZW1lbnQgfCBudWxsO1xuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAncGF5bWVudFJlcXVlc3RCdXR0b24nKTogU3RyaXBlUGF5bWVudFJlcXVlc3RCdXR0b25FbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ3NoaXBwaW5nQWRkcmVzcycpOiBTdHJpcGVTaGlwcGluZ0FkZHJlc3NFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZSkge1xuICAgIGlmICghdGhpcy5fZWxlbWVudHMpIHJldHVybiBudWxsO1xuXG4gICAgc3dpdGNoIChlbGVtZW50VHlwZSkge1xuICAgICAgY2FzZSAnYWRkcmVzcyc6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdhZGRyZXNzJyk7XG4gICAgICBjYXNlICdwYXltZW50TWV0aG9kTWVzc2FnaW5nJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ3BheW1lbnRNZXRob2RNZXNzYWdpbmcnKTtcbiAgICAgIGNhc2UgJ2FmZmlybU1lc3NhZ2UnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnYWZmaXJtTWVzc2FnZScpO1xuICAgICAgY2FzZSAnYWZ0ZXJwYXlDbGVhcnBheU1lc3NhZ2UnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnYWZ0ZXJwYXlDbGVhcnBheU1lc3NhZ2UnKTtcbiAgICAgIGNhc2UgJ2F1QmFua0FjY291bnQnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnYXVCYW5rQWNjb3VudCcpO1xuICAgICAgY2FzZSAnY2FyZCc6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdjYXJkJyk7XG4gICAgICBjYXNlICdjYXJkTnVtYmVyJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ2NhcmROdW1iZXInKTtcbiAgICAgIGNhc2UgJ2NhcmRFeHBpcnknOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnY2FyZEV4cGlyeScpO1xuICAgICAgY2FzZSAnY2FyZEN2Yyc6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdjYXJkQ3ZjJyk7XG4gICAgICBjYXNlICdmcHhCYW5rJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ2ZweEJhbmsnKTtcbiAgICAgIGNhc2UgJ2Vwc0JhbmsnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnZXBzQmFuaycpO1xuICAgICAgY2FzZSAncDI0QmFuayc6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdwMjRCYW5rJyk7XG4gICAgICBjYXNlICdpYmFuJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ2liYW4nKTtcbiAgICAgIGNhc2UgJ2lkZWFsQmFuayc6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdpZGVhbEJhbmsnKTtcbiAgICAgIGNhc2UgJ2xpbmtBdXRoZW50aWNhdGlvbic6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdsaW5rQXV0aGVudGljYXRpb24nKTtcbiAgICAgIGNhc2UgJ2V4cHJlc3NDaGVja291dCc6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdleHByZXNzQ2hlY2tvdXQnKTtcbiAgICAgIGNhc2UgJ3BheW1lbnQnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgncGF5bWVudCcpO1xuICAgICAgY2FzZSAncGF5bWVudFJlcXVlc3RCdXR0b24nOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgncGF5bWVudFJlcXVlc3RCdXR0b24nKTtcbiAgICAgIGNhc2UgJ3NoaXBwaW5nQWRkcmVzcyc6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdzaGlwcGluZ0FkZHJlc3MnKTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KGVsZW1lbnRUeXBlKTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==